<div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #2d3748; max-width: 100%; margin: 0 auto; padding: 0;"> <div style="background: linear-gradient(135deg, #FF6B6B 0%, #C92A2A 100%); color: white; padding: 50px 40px; text-align: center; border-radius: 12px; margin: 0 0 20px 0;" role="banner" aria-labelledby="lesson-title"> <div id="lesson-title" style="font-size: clamp(1.8em, 5vw, 3em); margin-bottom: 15px;" role="img" aria-label="Engineering and experimentation emoji"><strong>üî¨ Week 4: F=ma Investigation &amp; Engineering Application</strong> üíª</div> <p style="margin: 0; font-size: clamp(1em, 2.5vw, 1.2em);">Grade 8 Science | Rosche | Kairos Academies</p> <p style="margin: 10px 0 0 0; font-size: clamp(0.9em, 2vw, 1em);">MS-PS2-2 Engineering Design Project | 115 Points Total | ~80 Minutes</p> </div> <div style="background: linear-gradient(135deg, #51CF66 0%, #2F9E44 100%); padding: 20px; border-radius: 8px; margin-bottom: 25px;"> <h2 style="margin: 0 0 15px 0; text-align: center; color: white; font-size: clamp(1.1em, 3vw, 1.3em);">üß≠ <strong>Quick Navigation</strong></h2> <div style="text-align: center;"><a style="background: rgba(255, 255, 255, 0.95); color: #2f9e44; padding: 14px 24px; border-radius: 6px; text-decoration: none; font-size: 0.95em; display: inline-block; margin: 5px; min-height: 48px; line-height: 1.4;" href="#hook-heading">üî¨ Hook (10 pts)</a> <a style="background: rgba(255, 255, 255, 0.95); color: #2f9e44; padding: 14px 24px; border-radius: 6px; text-decoration: none; font-size: 0.95em; display: inline-block; margin: 5px; min-height: 48px; line-height: 1.4;" href="#station1-heading">‚ö° Station 1 (25 pts)</a> <a style="background: rgba(255, 255, 255, 0.95); color: #2f9e44; padding: 14px 24px; border-radius: 6px; text-decoration: none; font-size: 0.95em; display: inline-block; margin: 5px; min-height: 48px; line-height: 1.4;" href="#station2-heading">‚öñÔ∏è Station 2 (25 pts)</a> <a style="background: rgba(255, 255, 255, 0.95); color: #2f9e44; padding: 14px 24px; border-radius: 6px; text-decoration: none; font-size: 0.95em; display: inline-block; margin: 5px; min-height: 48px; line-height: 1.4;" href="#station3-heading">üöó Station 3 (30 pts)</a> <a style="background: rgba(255, 255, 255, 0.95); color: #2f9e44; padding: 14px 24px; border-radius: 6px; text-decoration: none; font-size: 0.95em; display: inline-block; margin: 5px; min-height: 48px; line-height: 1.4;" href="#exit-heading">üéì Exit Ticket (25 pts)</a></div> </div> <div style="background: white; border-left: 5px solid #E67E22; padding: 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="standards-heading"> <h2 id="standards-heading" style="margin: 0 0 15px 0; color: #e67e22; font-size: clamp(1.2em, 3vw, 1.4em);">üìö <strong>NGSS Standards Covered This Week</strong></h2> <div style="background: #FFF5EB; padding: 15px; border-radius: 6px; margin-bottom: 10px;"> <p style="margin: 0 0 8px 0; color: #2d3748; font-size: 1.05em;"><strong>MS-PS2-2</strong> (Primary Focus)</p> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #4a5568;"><strong>Performance Expectation:</strong> Plan an investigation to provide evidence that the change in an object's motion depends on the sum of the forces on the object and the mass of the object.</p> <p style="margin: 0; font-size: 0.85em; color: #718096;"><strong>DCI:</strong> PS2.A Forces and Motion | <strong>SEP:</strong> SEP-3 Planning and Carrying Out Investigations | <strong>CCC:</strong> CCC-3 Scale, Proportion, and Quantity</p> </div> <div style="background: #E3F2FD; padding: 15px; border-radius: 6px; margin-bottom: 10px;"> <p style="margin: 0 0 8px 0; color: #2d3748; font-size: 1.05em;"><strong>MS-ETS1-1</strong> (Integrated)</p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Define the criteria and constraints of a design problem with sufficient precision to ensure a successful solution.</p> </div> <div style="background: #E3F2FD; padding: 15px; border-radius: 6px; margin-bottom: 10px;"> <p style="margin: 0 0 8px 0; color: #2d3748; font-size: 1.05em;"><strong>MS-ETS1-2</strong> (Integrated)</p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Evaluate competing design solutions using a systematic process to determine how well they meet the criteria and constraints of the problem.</p> </div> <div style="background: #F3E5F5; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; color: #2d3748; font-size: 1.05em;"><strong>Crosscutting Concept: Proportional Relationships</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Algebraic thinking is used to examine scientific data and predict the effect of a change in one variable on another (F=ma).</p> </div> </div> <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 25px 20px; margin-bottom: 25px; border-radius: 8px; text-align: center;" role="region" aria-labelledby="targets-heading"> <h2 id="targets-heading" style="margin: 0 0 10px 0; color: #2d3748; font-size: clamp(1.4em, 4vw, 1.8em);">üéØ <strong>Your Goals This Week</strong></h2> <p style="margin: 0; color: #4a5568; font-size: clamp(0.95em, 2.5vw, 1.05em);">By the end of this week, you'll be able to:</p> </div> <div style="background: #F0FFF4; border: 2px solid #51CF66; padding: 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="success-heading"> <h3 id="success-heading" style="margin: 0 0 15px 0; color: #2d3748; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>How You'll Know You've Got This</strong></h3> <div style="background: white; padding: 15px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #51CF66;"> <p style="margin: 0 0 8px 0; font-size: 1.05em; color: #2d3748;"><strong>üî¨ Run Scientific Investigations</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Use PhET simulations systematically, keep variables controlled, and collect precise data across multiple trials.</p> </div> <div style="background: white; padding: 15px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #51CF66;"> <p style="margin: 0 0 8px 0; font-size: 1.05em; color: #2d3748;"><strong>üìä Analyze Your Data</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Calculate acceleration from your measurements, identify patterns (does doubling force double acceleration?), and verify F=ma mathematically.</p> </div> <div style="background: white; padding: 15px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #2F9E44;"> <p style="margin: 0 0 8px 0; font-size: 1.05em; color: #2d3748;"><strong>üõ†Ô∏è Design an Actual Safety System</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Create a collision safety solution that uses Newton's 3rd Law, energy principles, and F=ma. Show calculations and justify every design choice with physics.</p> </div> <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #2F9E44;"> <p style="margin: 0 0 8px 0; font-size: 1.05em; color: #2d3748;"><strong>üîó Put It All Together</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568;">Explain collision problems using Newton's 3rd Law (Week 1), kinetic energy (Week 2), and F=ma (Weeks 3-4) all at once.</p> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); border-radius: 12px; padding: 30px 24px; margin: 35px 0;" role="region" aria-labelledby="phenomenon-heading"> <h2 id="phenomenon-heading" style="margin: 0 0 15px 0; font-size: clamp(1.4em, 4vw, 1.8em); color: #2d3748;">üöó <strong>The Challenge: Be a Collision Safety Engineer</strong></h2> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px;"> <p style="font-size: clamp(0.95em, 2.5vw, 1.1em); margin-bottom: 15px; color: #4a5568; line-height: 1.7;">You've been hired to design a collision safety system for cars. Here's the catch: you can't just make everything "stronger." You need to use physics to reduce the forces people feel during crashes.</p> </div> <div style="background: linear-gradient(135deg, #FF6B6B 0%, #C92A2A 100%); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 20px 0;"> <p style="margin: 0; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>ü§î How can you use Newton's Laws and your simulation data to design a system that saves lives?</strong></p> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-top: 15px;"> <p style="margin: 0 0 12px 0; font-size: 1em; color: #2d3748;">üìä <strong>Why This Matters:</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568; line-height: 1.7;">Car safety has improved by 80% since 1960 using these exact physics principles. Modern crumple zones extend crash time from 0.01s to 0.10s, reducing forces by 10&times;. Airbags cut forces in half again. The work you're doing this week? It's the same physics that saves 30,000+ lives per year.</p> </div> </div> <div style="background: linear-gradient(135deg, #FFF5EB 0%, #FFE8D6 100%); border-left: 5px solid #E67E22; padding: 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="overview-heading"> <h3 id="overview-heading" style="margin: 0 0 15px 0; color: #2d3748; font-size: clamp(1.2em, 3vw, 1.4em);"><strong>üìã What You'll Do This Week</strong></h3> <p style="margin: 0 0 15px 0; font-size: 1.05em; color: #2d3748;">Last week you <strong>planned</strong> your investigations. This week you'll <strong>run</strong> them using PhET simulations and apply what you learn.</p> <div style="background: white; padding: 15px; border-radius: 6px; margin-top: 15px;"> <ol style="margin: 0; padding-left: 20px; color: #4a5568; line-height: 1.8; font-size: 0.95em;"> <li><strong>Hook:</strong> Review simulation setup and make predictions</li> <li><strong>Station 1:</strong> Change force, keep mass constant ‚Üí collect YOUR data</li> <li><strong>Station 2:</strong> Change mass, keep force constant ‚Üí see the inverse relationship</li> <li><strong>Station 3:</strong> Design a collision safety system using everything you've learned</li> <li><strong>Exit Ticket:</strong> Show you've mastered all 4 weeks</li> </ol> </div> </div> <div style="background: #E3F2FD; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 20px; border-radius: 8px;"> <p style="margin: 0 0 8px 0; font-size: 1.05em; color: #1565c0;"><strong>üíª You'll Use PhET Simulations:</strong></p> <p style="margin: 0 0 10px 0; font-size: 0.95em; color: #1565c0; line-height: 1.7;">PhET simulations are research-based tools used by millions of students worldwide. They let you control variables precisely, collect accurate data, and run investigations that would be difficult or impossible in a physical classroom. Professional engineers and physicists use simulations just like these to test designs before building prototypes.</p> <p style="margin: 0; font-size: 0.9em; color: #1565c0;"><strong>Link:</strong> <a style="color: #0d47a1;" href="https://phet.colorado.edu/en/simulations/forces-and-motion-basics" target="_blank" rel="noopener">PhET Forces and Motion: Basics</a></p> </div> <div style="background: #D1ECF1; border-left: 4px solid #0C5460; padding: 15px; margin-bottom: 20px; border-radius: 8px;"> <p style="margin: 0; font-size: 1.05em; color: #0c5460;"><strong>üí° Quick Review:</strong></p> <ul style="margin: 8px 0 0 20px; padding-left: 0; color: #0c5460; line-height: 1.7; font-size: 0.95em;"> <li><strong>Week 1:</strong> Newton's 3rd Law‚Äîforces come in pairs, but different masses = different accelerations</li> <li><strong>Week 2:</strong> KE = &frac12;mv&sup2; and energy transforms during collisions</li> <li><strong>Week 3:</strong> You planned how to test F=ma relationships</li> <li><strong>Week 4:</strong> Run those tests + engineer a real solution</li> </ul> </div> <div style="background: white; border: 2px solid #FF6B6B; padding: 20px; margin-bottom: 30px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #c92a2a; font-size: clamp(1.2em, 3vw, 1.4em);"><strong>üìä Points Breakdown (115 Total)</strong></h3> <table style="width: 100%; border-collapse: collapse; margin-top: 15px;"><caption style="padding: 10px; text-align: left; color: #2d3748;">How you'll earn your points this week</caption> <thead> <tr style="background: #FF6B6B; color: white;"> <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6;" scope="col">Component</th> <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6;" scope="col">Points</th> <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6;" scope="col">What It Tests</th> </tr> </thead> <tbody> <tr style="background: #f8f9fa;"> <td style="padding: 12px; border: 1px solid #dee2e6;"><a style="color: #c92a2a; text-decoration: none;" href="#hook-heading">üî¨ Hook</a></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>10</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;">Simulation understanding, predictions, prep work</td> </tr> <tr> <td style="padding: 12px; border: 1px solid #dee2e6;"><a style="color: #c92a2a; text-decoration: none;" href="#station1-heading">‚ö° Station 1</a></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>25</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;">Force investigation data + analysis</td> </tr> <tr style="background: #f8f9fa;"> <td style="padding: 12px; border: 1px solid #dee2e6;"><a style="color: #c92a2a; text-decoration: none;" href="#station2-heading">‚öñÔ∏è Station 2</a></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>25</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;">Mass investigation data + analysis</td> </tr> <tr> <td style="padding: 12px; border: 1px solid #dee2e6;"><a style="color: #c92a2a; text-decoration: none;" href="#station3-heading">üöó Station 3</a></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>30</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;">Engineering design with calculations</td> </tr> <tr style="background: #f8f9fa;"> <td style="padding: 12px; border: 1px solid #dee2e6;"><a style="color: #c92a2a; text-decoration: none;" href="#exit-heading">üéì Exit Ticket</a></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>25</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;">Complete 4-week unit mastery</td> </tr> <tr style="background: #FF6B6B; color: white;"> <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>TOTAL</strong></td> <td style="padding: 12px; text-align: center; border: 1px solid #dee2e6;"><strong>115</strong></td> <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>Everything from Weeks 1-4</strong></td> </tr> </tbody> </table> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div id="hook-heading" style="background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%); color: white; padding: 30px 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="hook-title"> <h2 id="hook-title" style="margin: 0 0 10px 0; font-size: clamp(1.5em, 4vw, 2em); text-align: center;"><strong>üî¨ Hook: Simulation Setup &amp; Predictions</strong></h2> <p style="margin: 0; text-align: center; font-size: clamp(0.95em, 2.5vw, 1.1em);">10 Points | ~10 Minutes</p> </div> <div style="background: white; border: 2px solid #667EEA; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #667eea; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>Prepare for PhET Investigations!</strong></h3> <div style="background: #F7F7FF; padding: 18px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667EEA;"> <p style="margin: 0 0 12px 0; font-size: 1.05em; color: #2d3748;"><strong>What You'll Do:</strong> Before you start collecting data, you need to know how to use the PhET simulation effectively. This checks that you understand the controls, can set up proper trials, and know what data to collect.</p> </div> <div style="background: #E8F5E9; border-left: 4px solid #2F9E44; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 10px 0; font-size: 1em; color: #2d3748;"><strong>üéØ What This Checks:</strong></p> <ul style="margin: 0; padding-left: 20px; color: #4a5568; line-height: 1.7; font-size: 0.95em;"> <li>Can you navigate the PhET simulation controls?</li> <li>Do you know your procedure from Week 3?</li> <li>Can you make specific number predictions using F=ma?</li> <li>Have you thought about how to keep your data organized?</li> </ul> </div> <div style="background: #FFF5EB; border-left: 4px solid #E67E22; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #e67e22;"><strong>üí° Good vs. Weak Predictions:</strong></p> <table style="width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em;"> <thead> <tr style="background: #f8f9fa;"> <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; color: #2d3748;">‚ùå Too Vague</th> <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; color: #2d3748;">‚úÖ Specific &amp; Calculated</th> </tr> </thead> <tbody> <tr> <td style="padding: 10px; border: 1px solid #dee2e6; color: #4a5568;">"Acceleration will go up"</td> <td style="padding: 10px; border: 1px solid #dee2e6; color: #4a5568;">"Doubling force from 50N to 100N should double acceleration from ~1.0 m/s&sup2; to ~2.0 m/s&sup2;"</td> </tr> <tr style="background: #f8f9fa;"> <td style="padding: 10px; border: 1px solid #dee2e6; color: #4a5568;">"More mass = less acceleration"</td> <td style="padding: 10px; border: 1px solid #dee2e6; color: #4a5568;">"Doubling mass from 50kg to 100kg should cut acceleration in half from 2.0 m/s&sup2; to 1.0 m/s&sup2;"</td> </tr> </tbody> </table> </div> <div style="background: #E3F2FD; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #1565c0;"><strong>‚ö†Ô∏è Must score 8/10 to proceed to stations!</strong></p> <p style="margin: 0; font-size: 0.9em; color: #1565c0;">If you score below 8/10, review the feedback and ask your teacher for help before continuing.</p> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;"><iframe style="border: none; max-width: 100%; display: block;" src="https://docs.google.com/forms/d/e/1FAIpQLSdYK6rGmgp0aMFiA4hJ1G7jBP4fWaULei2CEh9m0SNqN8NiYQ/viewform?embedded=true" width="100%" height="1225" loading="lazy"></iframe></div> <div style="background: #EDF2F7; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #2d3748;"><strong>üéØ Success Check:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>Did you access the PhET simulation successfully?</li> <li>Can you make specific, quantitative predictions using F=ma?</li> <li>Do you understand which values to measure in the simulation?</li> <li>Are you ready to maintain controlled variables during investigations?</li> </ul> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div id="station1-heading" style="background: linear-gradient(135deg, #3498DB 0%, #2980B9 100%); color: white; padding: 30px 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="station1-title"> <h2 id="station1-title" style="margin: 0 0 10px 0; font-size: clamp(1.5em, 4vw, 2em); text-align: center;"><strong>‚ö° Station 1: Force Investigation</strong></h2> <p style="margin: 0; text-align: center; font-size: clamp(0.95em, 2.5vw, 1.1em);">25 Points | ~30 Minutes</p> </div> <div style="background: white; border: 2px solid #3498DB; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #3498db; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>Test: How does force affect acceleration?</strong></h3> <div style="background: #EBF8FF; padding: 18px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3498DB;"> <p style="margin: 0 0 12px 0; font-size: 1.05em; color: #2d3748;"><strong>üî¨ Your Mission:</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568; line-height: 1.7;">Use the PhET "Motion" tab to run your force investigation. Use the force slider to change the applied force, keep the object mass constant, collect data from at least 3 different force levels (minimum 3 trials each). The simulation will show you velocity and position‚Äîyou'll calculate acceleration. Does doubling force really double acceleration?</p> </div> <div style="background: #FFF3CD; border-left: 4px solid #856404; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #856404;"><strong>üìù Data Collection Tips:</strong></p> <ul style="margin: 0; padding-left: 20px; color: #856404; line-height: 1.7; font-size: 0.9em;"> <li><strong>Use the timer:</strong> Track exactly how long the object moves</li> <li><strong>Read carefully:</strong> The simulation gives you velocity, you calculate acceleration (a = &Delta;v/&Delta;t)</li> <li><strong>Reset between trials:</strong> Use the reset button to start fresh each time</li> <li><strong>Keep it organized:</strong> Record force, mass, time, initial velocity, final velocity for every trial</li> <li><strong>Check your work:</strong> Does F=ma match your data? Calculate expected vs. actual</li> </ul> </div> <div style="background: #FFF5EB; padding: 15px; border-radius: 6px; margin-bottom: 15px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üìä What You'll Test:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.8; color: #4a5568; font-size: 0.95em;"> <li><strong>Force Level 1:</strong> 50N (keep mass at 50kg) - 3 trials</li> <li><strong>Force Level 2:</strong> 100N (keep mass at 50kg) - 3 trials</li> <li><strong>Force Level 3:</strong> 200N (keep mass at 50kg) - 3 trials</li> </ul> <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #c92a2a; font-style: italic;"><strong>Critical:</strong> Mass MUST stay constant at 50kg for all trials. Only change the force!</p> </div> <div style="background: #E6FFFA; padding: 15px; border-radius: 6px; margin-bottom: 15px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üí° Validation Tips:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>At 50N: Your acceleration should be approximately 1 m/s&sup2; (&plusmn;20%: 0.8-1.2 m/s&sup2;)</li> <li>At 100N: Your acceleration should be approximately 2 m/s&sup2; (&plusmn;20%: 1.8-2.2 m/s&sup2;)</li> <li>At 200N: Your acceleration should be approximately 4 m/s&sup2; (&plusmn;20%: 3.8-4.2 m/s&sup2;)</li> <li>If your data is outside these ranges, check your calculations and measurements carefully</li> </ul> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;"><iframe style="border: none; max-width: 100%; display: block;" src="https://docs.google.com/forms/d/e/1FAIpQLSdr3ILbpBbQIYU5dXtv6C-DkjXDWTc0lwq_TxHi8Nh9Ohx7zw/viewform?embedded=true" width="100%" height="1675" loading="lazy"></iframe></div> <div style="background: #EDF2F7; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #2d3748;"><strong>üéØ Success Check:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>Did you collect complete data for all 3 force levels (9 trials total)?</li> <li>Did you calculate acceleration for each trial using a = &Delta;v/&Delta;t?</li> <li>Can you identify the pattern: when force doubles, acceleration doubles?</li> <li>Did you explain this relationship using F=ma and your actual data?</li> </ul> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div id="station2-heading" style="background: linear-gradient(135deg, #F39C12 0%, #E67E22 100%); color: white; padding: 30px 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="station2-title"> <h2 id="station2-title" style="margin: 0 0 10px 0; font-size: clamp(1.5em, 4vw, 2em); text-align: center;"><strong>‚öñÔ∏è Station 2: Mass Investigation</strong></h2> <p style="margin: 0; text-align: center; font-size: clamp(0.95em, 2.5vw, 1.1em);">25 Points | ~30 Minutes</p> </div> <div style="background: white; border: 2px solid #F39C12; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #f39c12; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>Test: How does mass affect acceleration?</strong></h3> <div style="background: #FFF5EB; padding: 18px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #E67E22;"> <p style="margin: 0 0 12px 0; font-size: 1.05em; color: #2d3748;"><strong>üî¨ Your Mission:</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568; line-height: 1.7;">Use the PhET "Motion" tab to run your mass investigation. Change the object's mass using the mass slider, but keep the applied force constant (same force setting every time). Collect data from at least 3 different mass levels (minimum 3 trials each). This is the trickier investigation‚Äîyou need to keep force constant while mass changes. Does doubling mass really cut acceleration in half?</p> </div> <div style="background: #FFF3CD; border-left: 4px solid #856404; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #856404;"><strong>‚ö†Ô∏è Critical Control:</strong></p> <p style="margin: 0; font-size: 0.9em; color: #856404; line-height: 1.7;">The FORCE must stay the same for every trial. Set your force slider to 100N and DON'T touch it. Only change the mass. This is how you isolate the effect of mass on acceleration. Write down your force setting so you can verify it stayed constant.</p> </div> <div style="background: #FFF5EB; padding: 15px; border-radius: 6px; margin-bottom: 15px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üìä What You'll Test:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.8; color: #4a5568; font-size: 0.95em;"> <li><strong>Mass Level 1:</strong> 50kg (keep force at 100N) - 3 trials</li> <li><strong>Mass Level 2:</strong> 100kg (keep force at 100N) - 3 trials</li> <li><strong>Mass Level 3:</strong> 200kg (keep force at 100N) - 3 trials</li> </ul> <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #c92a2a; font-style: italic;"><strong>Critical:</strong> Force MUST stay constant at 100N for all trials. Verify this before each trial!</p> </div> <div style="background: #E6FFFA; padding: 15px; border-radius: 6px; margin-bottom: 15px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üí° Validation Tips:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>At 50kg: Your acceleration should be approximately 2 m/s&sup2; (&plusmn;20%: 1.8-2.2 m/s&sup2;)</li> <li>At 100kg: Your acceleration should be approximately 1 m/s&sup2; (&plusmn;20%: 0.9-1.1 m/s&sup2;)</li> <li>At 200kg: Your acceleration should be approximately 0.5 m/s&sup2; (&plusmn;20%: 0.45-0.55 m/s&sup2;)</li> <li>If your data is outside these ranges, check your calculations and verify F stayed at 100N</li> </ul> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;"><iframe style="border: none; max-width: 100%; display: block;" src="https://docs.google.com/forms/d/e/1FAIpQLSeuh4K528OOpeVs_Um8aMzTMPEN4F26nL4Y0ZEJyJTozC26Ww/viewform?embedded=true" width="100%" height="1769" loading="lazy"></iframe></div> <div style="background: #EDF2F7; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #2d3748;"><strong>üéØ Success Check:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>Did you collect complete data for all 3 mass levels (9 trials total)?</li> <li>Did you verify that force stayed constant at 100N for every trial?</li> <li>Can you identify the inverse pattern: when mass doubles, acceleration halves?</li> <li>Did you explain this using a=F/m and the concept of inertia?</li> </ul> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div id="station3-heading" style="background: linear-gradient(135deg, #51CF66 0%, #2F9E44 100%); color: white; padding: 30px 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="station3-title"> <h2 id="station3-title" style="margin: 0 0 10px 0; font-size: clamp(1.5em, 4vw, 2em); text-align: center;"><strong>üöó Station 3: Engineering Design Challenge</strong></h2> <p style="margin: 0; text-align: center; font-size: clamp(0.95em, 2.5vw, 1.1em);">30 Points | ~35 Minutes</p> </div> <div style="background: white; border: 2px solid #51CF66; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #2f9e44; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>Design a Collision Safety System</strong></h3> <div style="background: #E8F5E9; padding: 18px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #2F9E44;"> <p style="margin: 0 0 12px 0; font-size: 1.05em; color: #2d3748;"><strong>üõ†Ô∏è Your Mission:</strong></p> <p style="margin: 0; font-size: 0.95em; color: #4a5568; line-height: 1.7;">Design a complete collision safety system. This isn't just "add padding." You need to show how your design uses Newton's 3rd Law, energy principles, and F=ma. Use your actual simulation data from Stations 1 and 2 to justify your choices. Include calculations showing how much your system reduces forces. This is where everything from all 4 weeks comes together.</p> </div> <div style="background: #E3F2FD; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #1565c0;"><strong>üí° Connect Your Data:</strong></p> <p style="margin: 0; font-size: 0.9em; color: #1565c0; line-height: 1.7;">Your simulation data showed you EXACTLY how force and mass affect acceleration. Now use those relationships to design safety features. For example: if your data showed that doubling mass cuts acceleration in half, how could you use that principle in a safety system? If your data showed force is proportional to acceleration, how can you reduce force during a crash?</p> </div> <div style="background: #FFF5EB; padding: 18px; border-radius: 8px; margin-bottom: 15px;"> <p style="margin: 0 0 12px 0; font-size: 1em; color: #2d3748;"><strong>üé® Your Design Must Include:</strong></p> <ol style="margin: 0; padding-left: 25px; line-height: 1.8; color: #4a5568; font-size: 0.95em;"> <li><strong>Safety Feature Selection:</strong> Which features (crumple zones, airbags, seatbelts, etc.) and why?</li> <li><strong>Physics Justification:</strong> How EACH feature uses physics from Weeks 1-4</li> <li><strong>Force Calculations:</strong> Show how your design reduces collision forces using F=&Delta;p/&Delta;t</li> <li><strong>Data Integration:</strong> Reference YOUR specific data from Stations 1 and 2</li> <li><strong>System Integration:</strong> Explain how features work together</li> </ol> </div> <div style="background: #FFFAF0; padding: 15px; border-radius: 6px; margin-bottom: 15px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üßÆ Example Calculation (You'll Do Similar):</strong></p> <div style="background: white; padding: 12px; border-radius: 6px; margin-top: 10px; border: 1px solid #E2E8F0;"> <p style="margin: 0 0 8px 0; font-size: 0.9em; color: #2d3748;"><strong>Scenario:</strong> 70kg passenger, 25m/s ‚Üí 0m/s</p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.85em;"> <li>&Delta;p = 70kg &times; 25m/s = 1,750 kg&middot;m/s</li> <li>Without crumple zone (&Delta;t = 0.01s): F = 1,750 / 0.01 = 175,000 N</li> <li>With crumple zone (&Delta;t = 0.10s): F = 1,750 / 0.10 = 17,500 N</li> <li>Reduction: 90% force reduction by extending time 10&times;</li> </ul> </div> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;"><iframe style="border: none; max-width: 100%; display: block;" src="https://docs.google.com/forms/d/e/1FAIpQLSf_-Ki1Wfv6sdiIN0oV5tXcp1rOgEzeIXwrJcZMbFKmuxWlDQ/viewform?embedded=true" width="100%" height="1545" loading="lazy"></iframe></div> <div style="background: #EDF2F7; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #2d3748;"><strong>üéØ Success Check:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>Did you clearly describe your complete safety system design?</li> <li>Can you explain how each feature uses physics from all 4 weeks?</li> <li>Did you include force reduction calculations with actual numbers?</li> <li>Did you reference your specific data from Stations 1 and 2?</li> <li>Does your design show how features work together as a system?</li> </ul> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div id="exit-heading" style="background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%); color: white; padding: 30px 20px; margin-bottom: 20px; border-radius: 8px;" role="region" aria-labelledby="exit-title"> <h2 id="exit-title" style="margin: 0 0 10px 0; font-size: clamp(1.5em, 4vw, 2em); text-align: center;"><strong>üéì Exit Ticket: Show Complete Mastery</strong></h2> <p style="margin: 0; text-align: center; font-size: clamp(0.95em, 2.5vw, 1.1em);">25 Points | ~25 Minutes</p> </div> <div style="background: white; border: 2px solid #8E2DE2; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #8e2de2; font-size: clamp(1.1em, 3vw, 1.3em);"><strong>Final Assessment: All 4 Weeks!</strong></h3> <div style="background: #F5F3FF; padding: 18px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #8E2DE2;"> <p style="margin: 0 0 12px 0; font-size: 1.05em; color: #2d3748;"><strong>What You'll Do:</strong> This final assessment tests your understanding of everything from Weeks 1-4. You'll show that you can use Newton's 3rd Law, energy principles, and F=ma together to solve complex problems. This includes diagnostic questions for Week 5 planning, F=ma mastery checks, a complex integrated problem, transfer application, and reflection.</p> </div> <div style="background: #FFE5E5; border-left: 4px solid #C92A2A; padding: 15px; margin-bottom: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #2d3748;"><strong>üéØ This Tests Your Understanding Of:</strong></p> <ul style="margin: 0; padding-left: 20px; color: #4a5568; line-height: 1.8; font-size: 0.95em;"> <li><strong>Week 1:</strong> Newton's 3rd Law and force pairs</li> <li><strong>Week 2:</strong> Kinetic energy and energy transformations</li> <li><strong>Week 3:</strong> How to plan investigations</li> <li><strong>Week 4:</strong> Running experiments and engineering solutions</li> <li><strong>All Together:</strong> Can you use all these principles to solve new problems?</li> </ul> </div> <div style="background: #FFF5EB; padding: 18px; border-radius: 8px; margin-bottom: 15px;"> <p style="margin: 0 0 12px 0; font-size: 1em; color: #2d3748;"><strong>üìã What's Included:</strong></p> <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 3px solid #667EEA;"> <p style="margin: 0; font-size: 0.9em; color: #2d3748;"><strong>Part 1: Week 5 Diagnostic</strong> (Not Graded)</p> <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #4a5568;">Help your teacher plan review sessions by honestly rating your understanding</p> </div> <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 3px solid #3498DB;"> <p style="margin: 0; font-size: 0.9em; color: #2d3748;"><strong>Part 2: F=ma Mastery Check</strong> (8 points)</p> <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #4a5568;">Show you've mastered the core F=ma relationship using YOUR data</p> </div> <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 3px solid #51CF66;"> <p style="margin: 0; font-size: 0.9em; color: #2d3748;"><strong>Part 3: Complex Integrated Problem</strong> (10 points)</p> <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #4a5568;">Semi-truck vs sedan collision requiring ALL 4 weeks of physics</p> </div> <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 3px solid #F39C12;"> <p style="margin: 0; font-size: 0.9em; color: #2d3748;"><strong>Part 4: Transfer Application</strong> (4 points)</p> <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #4a5568;">Apply F=ma thinking to a new context (elevator design)</p> </div> <div style="background: white; padding: 12px; border-radius: 6px; border-left: 3px solid #8E2DE2;"> <p style="margin: 0; font-size: 0.9em; color: #2d3748;"><strong>Part 5: Metacognitive Reflection</strong> (3 points)</p> <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #4a5568;">What did you learn? What changed in your thinking?</p> </div> </div> <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;"><iframe style="border: none; max-width: 100%; display: block;" src="https://docs.google.com/forms/d/e/1FAIpQLSd39OxMLZBsp7QLGU-nfA-KMB4RKby9irasV2aDbEYWK-4olg/viewform?embedded=true" width="100%" height="2010" loading="lazy"></iframe></div> <div style="background: #EDF2F7; padding: 15px; border-radius: 6px;"> <p style="margin: 0 0 8px 0; font-size: 0.95em; color: #2d3748;"><strong>üéØ Success Check:</strong></p> <ul style="margin: 0; padding-left: 20px; line-height: 1.7; color: #4a5568; font-size: 0.9em;"> <li>Did you complete the diagnostic honestly to help with Week 5 planning?</li> <li>Can you explain the F=ma relationship using YOUR specific data?</li> <li>Did you apply ALL 4 weeks of physics to the complex collision scenario?</li> <li>Could you transfer F=ma thinking to a completely new context?</li> <li>Did you reflect on what you learned and how your thinking changed?</li> </ul> </div> </div> <hr style="border: 0; border-top: 2px solid #E2E8F0; margin: 40px 0;" /> <div style="background: linear-gradient(135deg, #F0FFF4 0%, #E8F5E9 100%); border: 3px solid #51CF66; padding: 25px 20px; margin-bottom: 25px; border-radius: 8px;" role="region" aria-labelledby="synthesis-heading"> <h2 id="synthesis-heading" style="margin: 0 0 15px 0; color: #2d3748; font-size: clamp(1.3em, 3.5vw, 1.6em); text-align: center;"><strong>üèÜ You're Now a Collision Physics Expert!</strong></h2> <div style="background: white; padding: 20px; border-radius: 8px;"> <p style="margin: 0; font-size: 1.05em; color: #2d3748; line-height: 1.7;">Over four weeks, you've gone from basic collision concepts to designing actual safety systems. You've run controlled investigations, analyzed data, and applied real physics. Professional engineers use the exact same simulation tools and physics principles you just mastered.</p> </div> </div> <div style="background: #F8F9FA; padding: 30px 20px; border-radius: 8px; margin-bottom: 20px;"> <p style="margin: 0 0 15px 0; font-size: clamp(1.1em, 3vw, 1.3em); color: #2d3748; text-align: center;"><strong>üíª Simulations Are Real Science</strong></p> <p style="margin: 0; font-size: clamp(0.95em, 2.5vw, 1.05em); color: #4a5568; line-height: 1.8;">PhET simulations are used by professional engineers and physicists worldwide to test designs before building prototypes. Your simulation data follows the same physics laws as physical experiments‚ÄîF=ma works the same way whether you're using a computer or a lab bench. NASA, SpaceX, and automotive companies all use computer simulations to design safety systems before testing physical prototypes. You're using professional-grade tools to do real physics.</p> </div> <div style="background: white; border: 2px solid #FF6B6B; padding: 20px; margin-bottom: 30px; border-radius: 8px;"> <h3 style="margin: 0 0 15px 0; color: #c92a2a; font-size: clamp(1.2em, 3vw, 1.4em);"><strong>üí¨ Need Help?</strong></h3> <table style="width: 100%; border-collapse: collapse;"> <thead> <tr style="background: #FF6B6B; color: white;"> <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6;" scope="col">üôã During Class</th> <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6;" scope="col">üìß After Class</th> <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6;" scope="col">üéÆ Online Tools</th> </tr> </thead> <tbody> <tr> <td style="padding: 12px; border: 1px solid #dee2e6; vertical-align: top;"> <ul style="margin: 0; padding-left: 20px; color: #4a5568; font-size: 0.9em; line-height: 1.6;"> <li>Raise your hand</li> <li>Check with classmates</li> <li>Try to solve it yourself first</li> <li>Refresh the simulation if it glitches</li> </ul> </td> <td style="padding: 12px; border: 1px solid #dee2e6; vertical-align: top;"> <ul style="margin: 0; padding-left: 20px; color: #4a5568; font-size: 0.9em; line-height: 1.6;"> <li><a style="color: #c92a2a;" href="mailto:louis.rosche@kairosacademies.org">louis.rosche@kairosacademies.org</a></li> <li>Review Week 3 plans</li> <li>Watch demo videos (Canvas)</li> <li>Practice with PhET at home</li> </ul> </td> <td style="padding: 12px; border: 1px solid #dee2e6; vertical-align: top;"> <ul style="margin: 0; padding-left: 20px; color: #4a5568; font-size: 0.9em; line-height: 1.6;"> <li><a style="color: #c92a2a;" href="https://phet.colorado.edu/en/simulations/forces-and-motion-basics" target="_blank" rel="noopener">PhET: Forces &amp; Motion</a></li> <li><a style="color: #c92a2a;" href="https://www.khanacademy.org/science/physics/forces-newtons-laws" target="_blank" rel="noopener">Khan Academy: Newton's Laws</a></li> <li><a style="color: #c92a2a;" href="https://www.physicsclassroom.com/class/newtlaws" target="_blank" rel="noopener">Physics Classroom</a></li> </ul> </td> </tr> </tbody> </table> </div> <div style="background: #D1ECF1; border-left: 4px solid #0C5460; padding: 20px; margin-bottom: 20px; border-radius: 8px;"> <p style="margin: 0 0 8px 0; font-size: 1em; color: #0c5460;"><strong>üí° How Grading Works:</strong></p> <ul style="margin: 0; padding-left: 20px; color: #0c5460; line-height: 1.7; font-size: 0.95em;"> <li><strong>Investigations (Stations 1-2):</strong> Graded on how systematically you collect data, how well you analyze patterns, and whether you can explain the physics relationships.</li> <li><strong>Engineering (Station 3):</strong> Graded on thoroughness, calculations, and how well you justify your design with physics and YOUR data.</li> <li><strong>Exit Ticket:</strong> Shows what you've learned across all 4 weeks.</li> <li><strong>80%+ = mastery.</strong> Below that? You'll get feedback and chances to improve.</li> <li><strong>Feedback within 48 hours</strong> via email, auto-syncs to Canvas.</li> </ul> </div> <div style="text-align: center; padding: 30px 20px; border-top: 2px solid #E2E8F0; margin-top: 30px; background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%); border-radius: 8px;"> <p style="margin: 0 0 10px 0; font-size: 1em; color: #495057;">Grade 8 Science | Cycle 2, Week 4</p> <p style="margin: 0 0 10px 0; font-size: 1em; color: #6c757d;">F=ma Investigation &amp; Engineering Application</p> <p style="margin: 0 0 10px 0; font-size: 0.95em; color: #6c757d;">Louis Rosche | Kairos Academies | 2024-2025</p> <p style="margin: 0; font-size: 0.9em; color: #6c757d;">Questions? <a style="color: #c92a2a; text-decoration: none;" href="mailto:louis.rosche@kairosacademies.org">louis.rosche@kairosacademies.org</a></p> </div> </div> Current Scripts Prior Sync. (Bugged) // Grade 7 Configuration const   GRADE_7  = {    domain :  'gradientlearning.instructure.com' ,    apiKey :  '23860~L6GtXcezRxzHDWYzKDHmemenxvCxzkVeDm4LRk7J3FDxf3chVnBuTMC4ZwF7Yx8V' ,    courseId :  '65243' ,    sheetName :  '7th Live Dashboard' ,    mappingSheet :  '7th Assignment Mapping' ,    trackingSheet :  '7th Sync Tracker' }; // Grade 8 Configuration const   GRADE_8  = {    domain :  'gradientlearning.instructure.com' ,    apiKey :  '23860~L6GtXcezRxzHDWYzKDHmemenxvCxzkVeDm4LRk7J3FDxf3chVnBuTMC4ZwF7Yx8V' ,    courseId :  '65244' ,    sheetName :  '8th Live Dashboard' ,    mappingSheet :  '8th Assignment Mapping' ,    trackingSheet :  '8th Sync Tracker' }; const   LOG_SHEET_NAME  =  'Sync Log' ; // === SETUP FUNCTIONS === function   setupGrade7Mapping () {    setupAssignmentMapping ( GRADE_7 ,  'Grade 7' );    initializeTrackingSheet ( GRADE_7 );    initializeLogSheet (); } function   setupGrade8Mapping () {    setupAssignmentMapping ( GRADE_8 ,  'Grade 8' );    initializeTrackingSheet ( GRADE_8 );    initializeLogSheet (); } function   setupAssignmentMapping ( config ,  gradeName ) {    const   ss  =  SpreadsheetApp . getActiveSpreadsheet ();    let   mappingSheet  =  ss . getSheetByName ( config . mappingSheet );      if  (! mappingSheet ) {      mappingSheet  =  ss . insertSheet ( config . mappingSheet );      mappingSheet . getRange ( 'A1:C1' ). setValues ([[ 'Column Letter' ,  'Assignment Name' ,  'Canvas Assignment ID' ]]);      mappingSheet . getRange ( 'A1:C1' ). setFontWeight ( 'bold' );   }      const   allAssignments  =  getAllCanvasAssignments ( config );    Logger . log ( `Total assignments fetched for  ${ gradeName } :  ${ allAssignments . length } ` );      const   targetAssignments  =  allAssignments . filter ( a  =>      a . name . includes ( gradeName ) &&      a . published   );      Logger . log ( `\nFound  ${ targetAssignments . length }  matching  ${ gradeName }  assignments` );    targetAssignments . forEach ( a  =>  Logger . log ( `" ${ a . name } " (ID:  ${ a . id } )` ));      if  ( targetAssignments . length  ===  0 ) {      SpreadsheetApp . getUi (). alert ( `No matching assignments found for  ${ gradeName } . Check execution log.` );      return ;   }      const   dataSheet  =  ss . getSheetByName ( config . sheetName );    const   headers  =  dataSheet . getRange ( 1 ,  1 ,  1 ,  dataSheet . getLastColumn ()). getValues ()[ 0 ];      const   mappingData  = [];    targetAssignments . forEach ( assignment  => {      const   colIndex  =  headers . findIndex ( h  =>  h . includes ( assignment . name . split ( ' (Responses)' )[ 0 ]));      if  ( colIndex  !== - 1 ) {        const   colLetter  =  String . fromCharCode ( 65  +  colIndex );        mappingData . push ([ colLetter ,  assignment . name ,  assignment . id ]);     }   });      if  ( mappingData . length  >  0 ) {      mappingSheet . getRange ( 2 ,  1 ,  mappingData . length ,  3 ). setValues ( mappingData );      SpreadsheetApp . getUi (). alert ( ` ${ gradeName } : Mapped  ${ mappingData . length }  assignments!` );   }  else  {      SpreadsheetApp . getUi (). alert ( ` ${ gradeName } : Could not auto-map. Manually fill the mapping sheet.` );   } } function   initializeTrackingSheet ( config ) {    const   ss  =  SpreadsheetApp . getActiveSpreadsheet ();    let   trackingSheet  =  ss . getSheetByName ( config . trackingSheet );      if  (! trackingSheet ) {      trackingSheet  =  ss . insertSheet ( config . trackingSheet );      trackingSheet . hideSheet ();   }      trackingSheet . clear ();    trackingSheet . getRange ( 'A1:D1' ). setValues ([[ 'Email' ,  'Assignment ID' ,  'Last Score' ,  'Sync Time' ]]); } function   initializeLogSheet () {    const   ss  =  SpreadsheetApp . getActiveSpreadsheet ();    let   logSheet  =  ss . getSheetByName ( LOG_SHEET_NAME );      if  (! logSheet ) {      logSheet  =  ss . insertSheet ( LOG_SHEET_NAME );      logSheet . getRange ( 'A1:H1' ). setValues ([[ 'Timestamp' ,  'Grade' ,  'Email' ,  'Assignment' ,  'Action' ,  'Old Value' ,  'New Value' ,  'Notes' ]]);      logSheet . getRange ( 'A1:H1' ). setFontWeight ( 'bold' ). setBackground ( '#4285F4' ). setFontColor ( '#FFFFFF' );      logSheet . setFrozenRows ( 1 );   } } function   logSyncEvent ( grade ,  email ,  assignmentName ,  action ,  oldValue ,  newValue ,  notes ) {    const   ss  =  SpreadsheetApp . getActiveSpreadsheet ();    let   logSheet  =  ss . getSheetByName ( LOG_SHEET_NAME );      if  (! logSheet ) {      initializeLogSheet ();      logSheet  =  ss . getSheetByName ( LOG_SHEET_NAME );   }      const   timestamp  =  new   Date ();    logSheet . appendRow ([ timestamp ,  grade ,  email ,  assignmentName ,  action ,  oldValue ,  newValue ,  notes ]); } // === SYNC FUNCTIONS === function   syncGrade7ToCanvas () {    syncGradesToCanvas ( GRADE_7 ,  'Grade 7' ); } function   syncGrade8ToCanvas () {    syncGradesToCanvas ( GRADE_8 ,  'Grade 8' ); } function   syncBothGradesToCanvas () {    const   msg1  =  syncGradesToCanvas ( GRADE_7 ,  'Grade 7' );    Utilities . sleep ( 2000 );    const   msg2  =  syncGradesToCanvas ( GRADE_8 ,  'Grade 8' );    SpreadsheetApp . getUi (). alert ( msg1  +  '\n'  +  msg2 ); } function   syncGradesToCanvas ( config ,  gradeName ) {    const   ss  =  SpreadsheetApp . getActiveSpreadsheet ();    const   dataSheet  =  ss . getSheetByName ( config . sheetName );    const   mappingSheet  =  ss . getSheetByName ( config . mappingSheet );    let   trackingSheet  =  ss . getSheetByName ( config . trackingSheet );    if  (! mappingSheet )  throw   new   Error ( ` ${ gradeName } : Run setup first!` );    if  (! trackingSheet ) {      initializeTrackingSheet ( config );      trackingSheet  =  ss . getSheetByName ( config . trackingSheet );   }      const   mappingData  =  mappingSheet . getDataRange (). getValues (). slice ( 1 );    if  ( mappingData . length  ===  0 )  throw   new   Error ( ` ${ gradeName } : No mappings found.` );      // Get tracking data    const   trackingData  =  trackingSheet . getDataRange (). getValues (). slice ( 1 );    const   trackingMap  = {};    trackingData . forEach ( row  => {      const   key  =  ` ${ row [ 0 ]} | ${ row [ 1 ]} ` ;      trackingMap [ key ] = {  score :  row [ 2 ],  time :  row [ 3 ] };   });      // Fetch assignments with due dates    const   allAssignments  =  getAllCanvasAssignments ( config );    const   assignmentInfo  = {};    allAssignments . forEach ( a  =>  assignmentInfo [ a . id ] = {      due_at :  a . due_at ,      points_possible :  a . points_possible ,      name :  a . name   });      const   data  =  dataSheet . getDataRange (). getValues ();    const   canvasUsers  =  getCanvasUsersByEmail ( config );      let   syncedCount  =  0 ;    let   skippedCount  =  0 ;    let   zerosSyncedCount  =  0 ;    let   errorCount  =  0 ;    const   errors  = [];    const   newTrackingData  = [[ 'Email' ,  'Assignment ID' ,  'Last Score' ,  'Sync Time' ]];      for  ( let   i  =  1 ;  i  <  data . length ;  i ++) {      const   email  =  data [ i ][ 0 ];      if  (! email  ||  email . includes ( '2cf164af' ))  continue ;          const   canvasUserId  =  canvasUsers [ email . toLowerCase ()];      if  (! canvasUserId ) {        errors . push ( `Student not found:  ${ email } ` );        logSyncEvent ( gradeName ,  email ,  'N/A' ,  'ERROR' ,  '' ,  '' ,  'Student not found in Canvas' );        errorCount ++;        continue ;     }          for  ( const   mapping   of   mappingData ) {        const   colLetter  =  mapping [ 0 ];        const   assignmentId  =  mapping [ 2 ];        const   assignmentName  =  mapping [ 1 ];              if  (! colLetter  || ! assignmentId )  continue ;              const   colIndex  =  colLetter . charCodeAt ( 0 ) -  65 ;        let   cellValue  =  data [ i ][ colIndex ];              // Detect blank cells (including formula cells that evaluate to blank)        const   isBlank  = ( cellValue  ===  ''  ||  cellValue  ===  null  ||  cellValue  ===  undefined );        let   score  =  isBlank  ?  null  :  Number ( cellValue );              if  (! isBlank  &&  isNaN ( score ))  score  =  0 ;  // Invalid entry = 0              const   trackingKey  =  ` ${ email } | ${ assignmentId } ` ;        const   lastSynced  =  trackingMap [ trackingKey ];        const   assignmentData  =  assignmentInfo [ assignmentId ];        const   isPastDue  =  assignmentData ?. due_at  ?  new   Date () >  new   Date ( assignmentData . due_at ) :  true ;              // === LOGIC FLOW ===              // Case 1: Blank cell before due date ‚Üí SKIP        if  ( isBlank  && ! isPastDue ) {          skippedCount ++;          logSyncEvent ( gradeName ,  email ,  assignmentName ,  'SKIPPED' ,  'blank' ,  'blank' ,  'Before due date, no submission' );          if  ( lastSynced ) {            newTrackingData . push ([ email ,  assignmentId ,  lastSynced . score ,  lastSynced . time ]);         }          continue ;       }              // Case 2: Blank cell after due date ‚Üí Sync 0 to Canvas WITHOUT overwriting sheet cell        if  ( isBlank  &&  isPastDue ) {          score  =  0 ;          // FIXED: No longer updating the cell in Google Sheets          // This preserves formulas and allows form responses to populate later                  const   success  =  submitGradeToCanvas ( config ,  assignmentId ,  canvasUserId ,  0 );                  if  ( success ) {            zerosSyncedCount ++;            newTrackingData . push ([ email ,  assignmentId ,  0 ,  new   Date ()]);            logSyncEvent ( gradeName ,  email ,  assignmentName ,  'ZERO_SYNCED' ,  'blank' ,  '0 (Canvas only)' ,  'Past due, sheet cell preserved' );         }  else  {            errorCount ++;            errors . push ( `Failed to sync 0:  ${ assignmentName }  for  ${ email } ` );            logSyncEvent ( gradeName ,  email ,  assignmentName ,  'ERROR' ,  'blank' ,  '0' ,  'Failed to sync zero to Canvas' );         }                  Utilities . sleep ( 100 );          continue ;       }              // Case 3: Has value - check if changed        const   hasChanged  = ! lastSynced  ||  lastSynced . score  !==  score ;              if  (! hasChanged ) {          // No change, preserve tracking          newTrackingData . push ([ email ,  assignmentId ,  lastSynced . score ,  lastSynced . time ]);          continue ;       }              // Case 4: Value changed - sync to Canvas        const   maxPoints  =  assignmentData ?. points_possible  ||  100 ;        const   cappedScore  =  Math . min ( score ,  maxPoints );              const   success  =  submitGradeToCanvas ( config ,  assignmentId ,  canvasUserId ,  cappedScore );              if  ( success ) {          syncedCount ++;          newTrackingData . push ([ email ,  assignmentId ,  cappedScore ,  new   Date ()]);          const   oldVal  =  lastSynced  ?  lastSynced . score  :  'none' ;          logSyncEvent ( gradeName ,  email ,  assignmentName ,  'SYNCED' ,  oldVal ,  cappedScore ,  isPastDue  ?  'Past due'  :  'Before due' );       }  else  {          errorCount ++;          errors . push ( `Failed:  ${ assignmentName }  for  ${ email } ` );          logSyncEvent ( gradeName ,  email ,  assignmentName ,  'ERROR' ,  lastSynced ?. score  ||  '' ,  cappedScore ,  'Sync failed' );          if  ( lastSynced ) {            newTrackingData . push ([ email ,  assignmentId ,  lastSynced . score ,  lastSynced . time ]);         }       }              Utilities . sleep ( 100 );     }   }      // Update tracking sheet    trackingSheet . clear ();    if  ( newTrackingData . length  >  1 ) {      trackingSheet . getRange ( 1 ,  1 ,  newTrackingData . length ,  4 ). setValues ( newTrackingData );   }  else  {      trackingSheet . getRange ( 'A1:D1' ). setValues ([ newTrackingData [ 0 ]]);   }      const   message  =  ` ${ gradeName } : ‚úì  ${ syncedCount }  synced | 0Ô∏è‚É£  ${ zerosSyncedCount }  zeros to Canvas | ‚è≠  ${ skippedCount }  skipped | ‚úó  ${ errorCount }  errors` ;    if  ( errors . length  >  0 )  Logger . log ( ` ${ gradeName }  Errors:\n`  +  errors . join ( '\n' ));    Logger . log ( message );      logSyncEvent ( gradeName ,  'SUMMARY' ,  'All' ,  'COMPLETE' ,  '' ,  '' ,  message );      return   message ; } // === AUTO-SYNC === function   enableAutoSync () {    ScriptApp . getProjectTriggers (). forEach ( trigger  => {      if  ( trigger . getHandlerFunction () ===  'smartSync' ) {        ScriptApp . deleteTrigger ( trigger );     }   });      ScriptApp . newTrigger ( 'smartSync' )     . timeBased ()     . everyMinutes ( 15 )     . create ();      SpreadsheetApp . getUi (). alert ( '‚úì Auto-sync enabled for BOTH grades!\n\n‚Ä¢ School hours: Every 15 min\n‚Ä¢ Evenings/weekends: Reduced frequency\n‚Ä¢ Only syncs CHANGED grades\n‚Ä¢ Syncs zeros to Canvas after due date\n‚Ä¢ Preserves sheet formulas\n‚Ä¢ Full logging enabled' ); } function   disableAutoSync () {    ScriptApp . getProjectTriggers (). forEach ( trigger  => {      if  ( trigger . getHandlerFunction () ===  'smartSync' ) {        ScriptApp . deleteTrigger ( trigger );     }   });      SpreadsheetApp . getUi (). alert ( '‚úì Auto-sync disabled for both grades' ); } function   smartSync () {    const   now  =  new   Date ();    const   day  =  now . getDay ();    const   hour  =  now . getHours ();      if  ( day  ===  0  ||  day  ===  6 ) {      if  ( hour  !==  17 )  return ;   }  else  {      if  ( hour  <  7  ||  hour  >=  16 ) {        if  ( hour  !==  17  &&  hour  !==  20 )  return ;     }   }      syncGradesToCanvas ( GRADE_7 ,  'Grade 7' );    Utilities . sleep ( 2000 );    syncGradesToCanvas ( GRADE_8 ,  'Grade 8' ); } // === HELPER FUNCTIONS === function   getAllCanvasAssignments ( config ) {    let   allAssignments  = [];    let   page  =  1 ;    let   hasMore  =  true ;      while  ( hasMore ) {      const   url  =  `https:// ${ config . domain } /api/v1/courses/ ${ config . courseId } /assignments?per_page=100&page= ${ page } ` ;      const   options  = {        method :  'get' ,        headers : {  'Authorization' :  'Bearer '  +  config . apiKey  },        muteHttpExceptions :  true     };          const   response  =  UrlFetchApp . fetch ( url ,  options );      const   assignments  =  JSON . parse ( response . getContentText ());          if  ( assignments . length  ===  0 ) {        hasMore  =  false ;     }  else  {        allAssignments  =  allAssignments . concat ( assignments );        page ++;     }          Utilities . sleep ( 200 );   }      return   allAssignments ; } function   getCanvasUsersByEmail ( config ) {    const   url  =  `https:// ${ config . domain } /api/v1/courses/ ${ config . courseId } /users?enrollment_type[]=student&per_page=100` ;    const   options  = {      method :  'get' ,      headers : {  'Authorization' :  'Bearer '  +  config . apiKey  },      muteHttpExceptions :  true   };      const   response  =  UrlFetchApp . fetch ( url ,  options );    const   users  =  JSON . parse ( response . getContentText ());      const   emailMap  = {};    for  ( const   user   of   users ) {      if  ( user . login_id ) {        emailMap [ user . login_id . toLowerCase ()] =  user . id ;     }   }      return   emailMap ; } function   submitGradeToCanvas ( config ,  assignmentId ,  userId ,  score ) {    const   url  =  `https:// ${ config . domain } /api/v1/courses/ ${ config . courseId } /assignments/ ${ assignmentId } /submissions/ ${ userId } ` ;    const   payload  = {  'submission' : {  'posted_grade' :  score  } };      const   options  = {      method :  'put' ,      headers : {        'Authorization' :  'Bearer '  +  config . apiKey ,        'Content-Type' :  'application/json'     },      payload :  JSON . stringify ( payload ),      muteHttpExceptions :  true   };      try  {      const   response  =  UrlFetchApp . fetch ( url ,  options );      return   response . getResponseCode () ===  200 ;   }  catch  ( e ) {      Logger . log ( `Submit error:  ${ e } ` );      return   false ;   } } function   onOpen () {    const   ui  =  SpreadsheetApp . getUi ();      ui . createMenu ( 'Grade 7 Sync' )     . addItem ( '‚öôÔ∏è Setup Mapping' ,  'setupGrade7Mapping' )     . addItem ( 'üîÑ Sync to Canvas' ,  'syncGrade7ToCanvas' )     . addToUi ();      ui . createMenu ( 'Grade 8 Sync' )     . addItem ( '‚öôÔ∏è Setup Mapping' ,  'setupGrade8Mapping' )     . addItem ( 'üîÑ Sync to Canvas' ,  'syncGrade8ToCanvas' )     . addToUi ();      ui . createMenu ( 'Both Grades' )     . addItem ( 'üîÑ Sync Both to Canvas' ,  'syncBothGradesToCanvas' )     . addItem ( 'ü§ñ Enable Auto-Sync' ,  'enableAutoSync' )     . addItem ( '‚è∏Ô∏è Disable Auto-Sync' ,  'disableAutoSync' )     . addToUi (); } Current WIP Sync. (Validating) // ============================================================================ // CANVAS GRADE SYNC - Production-Ready Version // Syncs Google Sheets formative assessments to Canvas LMS gradebook // ============================================================================ // === CONFIGURATION === // Grade 7 Configuration const GRADE_7 = {   domain: 'gradientlearning.instructure.com',   apiKey: '23860~L6GtXcezRxzHDWYzKDHmemenxvCxzkVeDm4LRk7J3FDxf3chVnBuTMC4ZwF7Yx8V',   courseId: '65243',   sheetName: '7th Live Dashboard',   mappingSheet: '7th Assignment Mapping',   trackingSheet: '7th Sync Tracker',   testStudentEmails: [] // Add test emails like: ['test7@school.org'] }; // Grade 8 Configuration const GRADE_8 = {   domain: 'gradientlearning.instructure.com',   apiKey: '23860~L6GtXcezRxzHDWYzKDHmemenxvCxzkVeDm4LRk7J3FDxf3chVnBuTMC4ZwF7Yx8V',   courseId: '65244',   sheetName: '8th Live Dashboard',   mappingSheet: '8th Assignment Mapping',   trackingSheet: '8th Sync Tracker',   testStudentEmails: [] // Add test emails like: ['test8@school.org'] }; // Auto-Sync Schedule Configuration const AUTO_SYNC_CONFIG = {   schoolStartHour: 7,   // 7am   schoolEndHour: 16,    // 4pm   eveningSyncHour: 17,  // 5pm   nightSyncHour: 20     // 8pm }; // Performance & Reliability Settings const PERFORMANCE_CONFIG = {   batchSize: 50,                    // Submissions per batch (Canvas supports up to 100)   maxRetries: 3,                    // API retry attempts   retryBaseDelay: 1000,             // Initial retry delay (ms)   apiDelay: 100,                    // Delay between API calls (ms)   batchDelay: 2000,                 // Delay between batches (ms)   scalabilityWarningThreshold: 30   // Warn if >30 assignments }; /**  * Get dry run status from Script Properties  * This allows the setting to persist across executions  */ function isDryRunMode() {   const props = PropertiesService.getScriptProperties();   const dryRunValue = props.getProperty('DRY_RUN_MODE');   // Default to false if not set   return dryRunValue === 'true'; } const LOG_SHEET_NAME = 'Sync Log'; // === COLUMN CONVERSION UTILITIES === /**  * Convert column number (0-indexed) to letter (A, B, ..., Z, AA, AB, ...)  */ function columnToLetter(column) {   let letter = '';   let col = column + 1;      while (col > 0) {     const remainder = (col - 1) % 26;     letter = String.fromCharCode(65 + remainder) + letter;     col = Math.floor((col - 1) / 26);   }      return letter; } /**  * Convert column letter to number (0-indexed)  */ function letterToColumn(letter) {   if (!letter || typeof letter !== 'string' || !/^[A-Za-z]+$/.test(letter)) {     Logger.log(`Invalid column letter: "${letter}"`);     return -1;   }      let column = 0;   for (let i = 0; i < letter.length; i++) {     column = column * 26 + (letter.toUpperCase().charCodeAt(i) - 64);   }   return column - 1; } // === SETUP FUNCTIONS === function setupGrade7Mapping() {   setupAssignmentMapping(GRADE_7, 'Grade 7');   initializeTrackingSheet(GRADE_7);   initializeLogSheet(); } function setupGrade8Mapping() {   setupAssignmentMapping(GRADE_8, 'Grade 8');   initializeTrackingSheet(GRADE_8);   initializeLogSheet(); } function setupAssignmentMapping(config, gradeName) {   const ss = SpreadsheetApp.getActiveSpreadsheet();   let mappingSheet = ss.getSheetByName(config.mappingSheet);      if (!mappingSheet) {     mappingSheet = ss.insertSheet(config.mappingSheet);     mappingSheet.getRange('A1:C1').setValues([['Column Letter', 'Assignment Name', 'Canvas Assignment ID']]);     mappingSheet.getRange('A1:C1').setFontWeight('bold');   }      const allAssignments = getAllCanvasAssignments(config);   Logger.log(`Total assignments fetched for ${gradeName}: ${allAssignments.length}`);      const targetAssignments = allAssignments.filter(a =>      a.name.includes(gradeName) &&     a.published   );      Logger.log(`\nFound ${targetAssignments.length} matching ${gradeName} assignments`);   targetAssignments.forEach(a => Logger.log(`"${a.name}" (ID: ${a.id})`));      if (targetAssignments.length === 0) {     SpreadsheetApp.getUi().alert(`No matching assignments found for ${gradeName}. Check execution log.`);     return;   }      const dataSheet = ss.getSheetByName(config.sheetName);   const headers = dataSheet.getRange(1, 1, 1, dataSheet.getLastColumn()).getValues()[0];      const mappingData = [];   targetAssignments.forEach(assignment => {     const colIndex = headers.findIndex(h => h.includes(assignment.name.split(' (Responses)')[0]));     if (colIndex !== -1) {       const colLetter = columnToLetter(colIndex);       mappingData.push([colLetter, assignment.name, assignment.id]);     }   });      if (mappingData.length > 0) {     mappingSheet.getRange(2, 1, mappingData.length, 3).setValues(mappingData);     SpreadsheetApp.getUi().alert(`${gradeName}: Mapped ${mappingData.length} assignments!`);   } else {     SpreadsheetApp.getUi().alert(`${gradeName}: Could not auto-map. Manually fill the mapping sheet.`);   } } function initializeTrackingSheet(config) {   const ss = SpreadsheetApp.getActiveSpreadsheet();   let trackingSheet = ss.getSheetByName(config.trackingSheet);      if (!trackingSheet) {     trackingSheet = ss.insertSheet(config.trackingSheet);     trackingSheet.hideSheet();   }      trackingSheet.clear();   trackingSheet.getRange('A1:D1').setValues([['Email', 'Assignment ID', 'Last Score', 'Sync Time']]); } function initializeLogSheet() {   const ss = SpreadsheetApp.getActiveSpreadsheet();   let logSheet = ss.getSheetByName(LOG_SHEET_NAME);      if (!logSheet) {     logSheet = ss.insertSheet(LOG_SHEET_NAME);     logSheet.getRange('A1:H1').setValues([['Timestamp', 'Grade', 'Email', 'Assignment', 'Action', 'Old Value', 'New Value', 'Notes']]);     logSheet.getRange('A1:H1').setFontWeight('bold').setBackground('#4285F4').setFontColor('#FFFFFF');     logSheet.setFrozenRows(1);   } } function logSyncEvent(grade, email, assignmentName, action, oldValue, newValue, notes) {   const ss = SpreadsheetApp.getActiveSpreadsheet();   let logSheet = ss.getSheetByName(LOG_SHEET_NAME);      if (!logSheet) {     initializeLogSheet();     logSheet = ss.getSheetByName(LOG_SHEET_NAME);   }      const timestamp = new Date();   logSheet.appendRow([timestamp, grade, email, assignmentName, action, oldValue, newValue, notes]); } // === SYNC FUNCTIONS === /**  * Validate configuration and data before syncing  * Prevents crashes from common setup errors  */ function validateSyncPrerequisites(config, gradeName) {   const ss = SpreadsheetApp.getActiveSpreadsheet();   const errors = [];      // Check API key format   if (!config.apiKey || config.apiKey.length < 20) {     errors.push('‚ùå API key appears invalid or missing');   }      // Check sheets exist   const dataSheet = ss.getSheetByName(config.sheetName);   if (!dataSheet) {     errors.push(`‚ùå Dashboard sheet "${config.sheetName}" not found`);   } else {     // Check sheet has data     if (dataSheet.getLastRow() < 2) {       errors.push(`‚ùå Dashboard sheet "${config.sheetName}" has no student data`);     }     // Check first column is email-like     const firstDataCell = dataSheet.getRange(2, 1).getValue();     if (firstDataCell && typeof firstDataCell === 'string' && !firstDataCell.includes('@')) {       errors.push('‚ö†Ô∏è First column may not contain email addresses');     }   }      const mappingSheet = ss.getSheetByName(config.mappingSheet);   if (!mappingSheet) {     errors.push(`‚ùå Mapping sheet "${config.mappingSheet}" not found. Run setup first.`);   } else {     if (mappingSheet.getLastRow() < 2) {       errors.push(`‚ùå Mapping sheet "${config.mappingSheet}" is empty. Run setup first.`);     }   }      // Check for test student configuration   if (config.testStudentEmails.length === 0) {     Logger.log(`‚ö†Ô∏è No test students configured for ${gradeName}. All students will be synced.`);   }      return errors; } function syncGrade7ToCanvas() {   const lock = LockService.getScriptLock();   try {     if (!lock.tryLock(5000)) {       SpreadsheetApp.getUi().alert('Sync already in progress. Please wait and try again.');       return;     }          // Validate before syncing     const validationErrors = validateSyncPrerequisites(GRADE_7, 'Grade 7');     if (validationErrors.length > 0) {       SpreadsheetApp.getUi().alert('Cannot sync - issues found:\n\n' + validationErrors.join('\n'));       return;     }          const result = syncGradesToCanvas(GRADE_7, 'Grade 7');     SpreadsheetApp.getUi().alert(result);   } finally {     lock.releaseLock();   } } function syncGrade8ToCanvas() {   const lock = LockService.getScriptLock();   try {     if (!lock.tryLock(5000)) {       SpreadsheetApp.getUi().alert('Sync already in progress. Please wait and try again.');       return;     }          // Validate before syncing     const validationErrors = validateSyncPrerequisites(GRADE_8, 'Grade 8');     if (validationErrors.length > 0) {       SpreadsheetApp.getUi().alert('Cannot sync - issues found:\n\n' + validationErrors.join('\n'));       return;     }          const result = syncGradesToCanvas(GRADE_8, 'Grade 8');     SpreadsheetApp.getUi().alert(result);   } finally {     lock.releaseLock();   } } function syncBothGradesToCanvas() {   const lock = LockService.getScriptLock();   try {     if (!lock.tryLock(5000)) {       SpreadsheetApp.getUi().alert('Sync already in progress. Please wait and try again.');       return;     }     const msg1 = syncGradesToCanvas(GRADE_7, 'Grade 7');     Utilities.sleep(2000);     const msg2 = syncGradesToCanvas(GRADE_8, 'Grade 8');     SpreadsheetApp.getUi().alert(msg1 + '\n\n' + msg2);   } finally {     lock.releaseLock();   } } function syncGradesToCanvas(config, gradeName) {   const ss = SpreadsheetApp.getActiveSpreadsheet();   const dataSheet = ss.getSheetByName(config.sheetName);   const mappingSheet = ss.getSheetByName(config.mappingSheet);   let trackingSheet = ss.getSheetByName(config.trackingSheet);   // ========================================================================   // CRITICAL: This script NEVER writes to the dashboard sheet (dataSheet)   // It ONLY READS from dashboard to sync grades to Canvas   // Writes only occur to: tracking sheet, log sheet, mapping sheet   // This preserves all formulas in the dashboard that pull from Google Forms   // ========================================================================   // === VALIDATION CHECKS ===      if (!dataSheet) {     throw new Error(`${gradeName}: Dashboard sheet "${config.sheetName}" not found!`);   }      if (!mappingSheet) {     throw new Error(`${gradeName}: Mapping sheet not found. Run "Setup Mapping" first!`);   }      if (!trackingSheet) {     Logger.log(`${gradeName}: Creating tracking sheet...`);     initializeTrackingSheet(config);     trackingSheet = ss.getSheetByName(config.trackingSheet);   }      // Warn if test students not configured (common oversight)   if (config.testStudentEmails.length === 0) {     Logger.log(`‚ö†Ô∏è WARNING: No test student emails configured for ${gradeName}`);     Logger.log('Add test accounts to config.testStudentEmails to exclude them from syncing');   }      const mappingData = mappingSheet.getDataRange().getValues().slice(1);   if (mappingData.length === 0) {     throw new Error(`${gradeName}: Mapping sheet is empty. Run "Setup Mapping" first!`);   }      // Scalability warning   if (mappingData.length > PERFORMANCE_CONFIG.scalabilityWarningThreshold) {     Logger.log(`‚ö†Ô∏è WARNING: ${mappingData.length} assignments for ${gradeName} may cause execution timeout (>6 min limit)`);   }      // Get tracking data   const trackingData = trackingSheet.getDataRange().getValues().slice(1);   const trackingMap = {};   trackingData.forEach(row => {     if (row.length >= 4 && row[0] && row[1] !== null && row[1] !== undefined) {       const key = `${row[0]}|${row[1]}`;       const rawScore = row[2];       const score = (rawScore !== null && rawScore !== undefined) ? Number(rawScore) : null;       trackingMap[key] = {          score: isNaN(score) ? null : score,         time: row[3] || null        };     }   });      // Fetch assignments with due dates   const allAssignments = getAllCanvasAssignments(config);   const assignmentInfo = {};   allAssignments.forEach(a => assignmentInfo[a.id] = {      due_at: a.due_at,      points_possible: a.points_possible,     name: a.name   });      const data = dataSheet.getDataRange().getValues();   const canvasUsers = getCanvasUsersByEmail(config);      const startTime = new Date();   let syncedCount = 0;   let skippedCount = 0;   let zerosSyncedCount = 0;   let unchangedCount = 0;   let errorCount = 0;   const errors = [];   const missingStudents = new Set(); // Track students not found in Canvas   const newTrackingData = [['Email', 'Assignment ID', 'Last Score', 'Sync Time']];      // Batch submission queue   const submissionQueue = [];      // Process all students and assignments   for (let i = 1; i < data.length; i++) {     const email = data[i][0];          // Skip empty rows and test students     if (!email || config.testStudentEmails.some(testEmail => email.toLowerCase().includes(testEmail.toLowerCase()))) {       continue;     }          // Validate email format to prevent crashes     if (typeof email !== 'string' || !email.includes('@')) {       errors.push(`Invalid email format in row ${i + 1}: "${email}"`);       logSyncEvent(gradeName, email, 'N/A', 'ERROR', '', '', 'Invalid email format');       errorCount++;       continue;     }          const canvasUserId = canvasUsers[email.toLowerCase()];     if (!canvasUserId) {       missingStudents.add(email);       logSyncEvent(gradeName, email, 'N/A', 'ERROR', '', '', 'Student not found in Canvas');       errorCount++;       continue;     }          for (const mapping of mappingData) {       const colLetter = mapping[0];       const assignmentId = mapping[2];       const assignmentName = mapping[1];              if (!colLetter || !assignmentId) continue;              const colIndex = letterToColumn(colLetter);       if (colIndex < 0) {         errors.push(`Invalid column letter "${colLetter}" for ${assignmentName}`);         logSyncEvent(gradeName, 'N/A', assignmentName, 'ERROR', '', '', `Invalid column letter: ${colLetter}`);         errorCount++;         continue;       }              if (colIndex >= data[i].length) {         errors.push(`Column ${colLetter} out of bounds for ${assignmentName}`);         logSyncEvent(gradeName, email, assignmentName, 'ERROR', '', '', `Column out of bounds: ${colLetter}`);         errorCount++;         continue;       }              let cellValue = data[i][colIndex];       const isBlank = (cellValue === '' || cellValue === null || cellValue === undefined);       let score = isBlank ? null : Number(cellValue);              if (!isBlank && isNaN(score)) score = 0;              const trackingKey = `${email}|${assignmentId}`;       const lastSynced = trackingMap[trackingKey];       const assignmentData = assignmentInfo[assignmentId];              if (!assignmentData) {         Logger.log(`WARNING: Assignment ID ${assignmentId} ("${assignmentName}") not found in Canvas`);         errors.push(`Assignment not in Canvas: ${assignmentName}`);         logSyncEvent(gradeName, email, assignmentName, 'WARNING', '', '', 'Assignment not found in Canvas');         continue;       }              // Check due date       const hasDueDate = assignmentData?.due_at && assignmentData.due_at !== null;       let isPastDue = false;              if (hasDueDate) {         const dueDate = new Date(assignmentData.due_at);         if (!isNaN(dueDate.getTime())) {           isPastDue = new Date() > dueDate;         }       }              // === SYNC LOGIC ===              // Case 1: Blank + not past due ‚Üí SKIP       if (isBlank && !isPastDue) {         skippedCount++;         const reason = hasDueDate ? 'Before due date, no submission' : 'No due date set, no submission';         logSyncEvent(gradeName, email, assignmentName, 'SKIPPED', 'blank', 'blank', reason);         if (lastSynced) {           newTrackingData.push([email, assignmentId, lastSynced.score, lastSynced.time]);         }         continue;       }              // Case 2: Blank + past due ‚Üí Sync 0       if (isBlank && isPastDue) {         if (lastSynced && lastSynced.score === 0) {           unchangedCount++;           newTrackingData.push([email, assignmentId, lastSynced.score, lastSynced.time]);           continue;         }                  score = 0;         submissionQueue.push({           assignmentId: assignmentId,           userId: canvasUserId,           score: 0,           email: email,           assignmentName: assignmentName,           lastSynced: lastSynced,           isZero: true,           isPastDue: isPastDue,           hasDueDate: hasDueDate         });         continue;       }              // Case 3: Has value - check if changed       const hasChanged = !lastSynced || lastSynced.score !== score;              if (!hasChanged) {         unchangedCount++;         newTrackingData.push([email, assignmentId, lastSynced.score, lastSynced.time]);         continue;       }              // Case 4: Value changed - queue for sync       const maxPoints = assignmentData?.points_possible || 100;       const cappedScore = Math.min(score, maxPoints);              submissionQueue.push({         assignmentId: assignmentId,         userId: canvasUserId,         score: cappedScore,         email: email,         assignmentName: assignmentName,         lastSynced: lastSynced,         isZero: false,         isPastDue: isPastDue,         hasDueDate: hasDueDate       });     }   }      // === BATCH SUBMISSION ===      if (submissionQueue.length > 0) {     Logger.log(`Processing ${submissionQueue.length} grade changes in batches of ${PERFORMANCE_CONFIG.batchSize}`);          const batchResults = submitGradesBatch(config, submissionQueue, gradeName);          // Process batch results     batchResults.forEach(result => {       if (result.success) {         if (result.isZero) {           zerosSyncedCount++;           logSyncEvent(gradeName, result.email, result.assignmentName, 'ZERO_SYNCED',              result.lastSynced?.score || 'blank', '0 (Canvas only)', 'Past due, sheet cell preserved');         } else {           syncedCount++;           const oldVal = result.lastSynced ? result.lastSynced.score : 'none';           const dueStatus = result.isPastDue ? 'Past due' : (result.hasDueDate ? 'Before due' : 'No due date');           logSyncEvent(gradeName, result.email, result.assignmentName, 'SYNCED', oldVal, result.score, dueStatus);         }         newTrackingData.push([result.email, result.assignmentId, result.score, new Date()]);       } else {         errorCount++;         errors.push(`Failed: ${result.assignmentName} for ${result.email}`);         logSyncEvent(gradeName, result.email, result.assignmentName, 'ERROR',            result.lastSynced?.score || '', result.score, result.error || 'Sync failed');         if (result.lastSynced) {           newTrackingData.push([result.email, result.assignmentId, result.lastSynced.score, result.lastSynced.time]);         }       }     });   }      // Update tracking sheet atomically   if (newTrackingData.length > 1) {     trackingSheet.getRange(1, 1, newTrackingData.length, 4).setValues(newTrackingData);     const currentRows = trackingSheet.getMaxRows();     if (currentRows > newTrackingData.length) {       trackingSheet.deleteRows(newTrackingData.length + 1, currentRows - newTrackingData.length);     }   } else {     trackingSheet.clear();     trackingSheet.getRange('A1:D1').setValues([newTrackingData[0]]);   }      // Performance metrics   const endTime = new Date();   const durationSeconds = ((endTime - startTime) / 1000).toFixed(1);   const totalItems = syncedCount + zerosSyncedCount + unchangedCount + skippedCount + errorCount;      const dryRunPrefix = isDryRunMode() ? '[DRY RUN] ' : '';   const message = `${dryRunPrefix}${gradeName}: ‚úì ${syncedCount} synced | 0Ô∏è‚É£ ${zerosSyncedCount} zeros | ‚úîÔ∏è ${unchangedCount} unchanged | ‚è≠ ${skippedCount} skipped | ‚úó ${errorCount} errors | ${totalItems} items in ${durationSeconds}s`;      if (errors.length > 0) Logger.log(`${gradeName} Errors:\n` + errors.slice(0, 10).join('\n'));   Logger.log(message);      logSyncEvent(gradeName, 'SUMMARY', 'All', 'COMPLETE', '', '', message);      return message; } // === BATCH SUBMISSION HELPER === /**  * Submit grades in batches with retry logic  * Research-based: Batch processing reduces API overhead and improves reliability  * (Google Apps Script Best Practices, 2024)  */ function submitGradesBatch(config, submissionQueue, gradeName) {   const results = [];   const batchSize = PERFORMANCE_CONFIG.batchSize;      for (let i = 0; i < submissionQueue.length; i += batchSize) {     const batch = submissionQueue.slice(i, i + batchSize);          Logger.log(`Processing batch ${Math.floor(i / batchSize) + 1}/${Math.ceil(submissionQueue.length / batchSize)} (${batch.length} submissions)`);          // Process each submission in batch with retry logic     batch.forEach(submission => {       if (isDryRunMode()) {         // Dry run mode - simulate success         results.push({           ...submission,           success: true         });         Logger.log(`[DRY RUN] Would sync: ${submission.email} - ${submission.assignmentName}: ${submission.score}`);       } else {         const success = submitGradeToCanvasWithRetry(           config,            submission.assignmentId,            submission.userId,            submission.score         );                  results.push({           ...submission,           success: success,           error: success ? null : 'API call failed after retries'         });       }              Utilities.sleep(PERFORMANCE_CONFIG.apiDelay);     });          // Delay between batches to respect rate limits     if (i + batchSize < submissionQueue.length) {       Utilities.sleep(PERFORMANCE_CONFIG.batchDelay);     }   }      return results; } // === AUTO-SYNC === function enableAutoSync() {   ScriptApp.getProjectTriggers().forEach(trigger => {     if (trigger.getHandlerFunction() === 'smartSync') {       ScriptApp.deleteTrigger(trigger);     }   });      ScriptApp.newTrigger('smartSync')     .timeBased()     .everyMinutes(15)     .create();      const scheduleMsg = `School hours: ${AUTO_SYNC_CONFIG.schoolStartHour}:00-${AUTO_SYNC_CONFIG.schoolEndHour}:00 (every 15 min)\nEvening: ${AUTO_SYNC_CONFIG.eveningSyncHour}:00 and ${AUTO_SYNC_CONFIG.nightSyncHour}:00\n\nTo change schedule, edit AUTO_SYNC_CONFIG at top of script.`;      SpreadsheetApp.getUi().alert(`‚úì Auto-sync enabled for BOTH grades!\n\n${scheduleMsg}\n\n‚Ä¢ Only syncs CHANGED grades\n‚Ä¢ Syncs zeros to Canvas after due date\n‚Ä¢ NEVER writes to dashboard sheets\n‚Ä¢ Full logging enabled\n‚Ä¢ Batch processing with retry logic`); } function disableAutoSync() {   ScriptApp.getProjectTriggers().forEach(trigger => {     if (trigger.getHandlerFunction() === 'smartSync') {       ScriptApp.deleteTrigger(trigger);     }   });      SpreadsheetApp.getUi().alert('‚úì Auto-sync disabled for both grades'); } function smartSync() {   const lock = LockService.getScriptLock();   try {     if (!lock.tryLock(5000)) {       Logger.log('Sync already in progress, skipping this run');       return;     }   } catch (e) {     Logger.log(`Failed to acquire lock: ${e.message}`);     return;   }      try {     const now = new Date();     const day = now.getDay();     const hour = now.getHours();          // Weekends: only sync at evening hour     if (day === 0 || day === 6) {       if (hour !== AUTO_SYNC_CONFIG.eveningSyncHour) return;     } else {       // Weekdays: sync during school hours, or at evening/night hours       if (hour < AUTO_SYNC_CONFIG.schoolStartHour || hour >= AUTO_SYNC_CONFIG.schoolEndHour) {         if (hour !== AUTO_SYNC_CONFIG.eveningSyncHour && hour !== AUTO_SYNC_CONFIG.nightSyncHour) return;       }     }          syncGradesToCanvas(GRADE_7, 'Grade 7');     Utilities.sleep(2000);     syncGradesToCanvas(GRADE_8, 'Grade 8');   } finally {     lock.releaseLock();   } } // === API HELPER FUNCTIONS === function getAllCanvasAssignments(config) {   let allAssignments = [];   let page = 1;   let hasMore = true;      while (hasMore) {     const url = `https://${config.domain}/api/v1/courses/${config.courseId}/assignments?per_page=100&page=${page}`;     const options = {       method: 'get',       headers: { 'Authorization': 'Bearer ' + config.apiKey },       muteHttpExceptions: true     };          try {       const response = UrlFetchApp.fetch(url, options);       const statusCode = response.getResponseCode();              if (statusCode !== 200) {         Logger.log(`Canvas API error (assignments page ${page}): Status ${statusCode}`);         Logger.log(`Response: ${response.getContentText()}`);         throw new Error(`Canvas API returned status ${statusCode}`);       }              const assignments = JSON.parse(response.getContentText());              if (assignments.length === 0) {         hasMore = false;       } else {         allAssignments = allAssignments.concat(assignments);         page++;       }     } catch (e) {       Logger.log(`Error fetching assignments: ${e.message}`);       throw new Error(`Failed to fetch assignments from Canvas: ${e.message}`);     }          Utilities.sleep(200);   }      return allAssignments; } function getCanvasUsersByEmail(config) {   let allUsers = [];   let page = 1;   let hasMore = true;      while (hasMore) {     const url = `https://${config.domain}/api/v1/courses/${config.courseId}/users?enrollment_type[]=student&per_page=100&page=${page}`;     const options = {       method: 'get',       headers: { 'Authorization': 'Bearer ' + config.apiKey },       muteHttpExceptions: true     };          try {       const response = UrlFetchApp.fetch(url, options);       const statusCode = response.getResponseCode();              if (statusCode !== 200) {         Logger.log(`Canvas API error (users page ${page}): Status ${statusCode}`);         Logger.log(`Response: ${response.getContentText()}`);         throw new Error(`Canvas API returned status ${statusCode}`);       }              const users = JSON.parse(response.getContentText());              if (users.length === 0) {         hasMore = false;       } else {         allUsers = allUsers.concat(users);         page++;       }     } catch (e) {       Logger.log(`Error fetching users: ${e.message}`);       throw new Error(`Failed to fetch users from Canvas: ${e.message}`);     }          Utilities.sleep(200);   }      const emailMap = {};   for (const user of allUsers) {     if (user.login_id) {       emailMap[user.login_id.toLowerCase()] = user.id;     }   }      return emailMap; } /**  * Submit grade with exponential backoff retry logic  * Research: Exponential backoff improves success rate for transient API failures  * (AWS Architecture Best Practices, 2024; Google Cloud Retry Strategy, 2024)  */ function submitGradeToCanvasWithRetry(config, assignmentId, userId, score) {   const maxRetries = PERFORMANCE_CONFIG.maxRetries;   const baseDelay = PERFORMANCE_CONFIG.retryBaseDelay;      for (let attempt = 1; attempt <= maxRetries; attempt++) {     const result = submitGradeToCanvas(config, assignmentId, userId, score);          if (result.success) {       if (attempt > 1) {         Logger.log(`Success on retry ${attempt - 1} for assignment ${assignmentId}`);       }       return true;     }          // Check if we should retry     if (attempt < maxRetries && result.shouldRetry) {       const delay = baseDelay * Math.pow(2, attempt - 1); // Exponential backoff       Logger.log(`Retry ${attempt}/${maxRetries} for assignment ${assignmentId} after ${delay}ms (reason: ${result.error})`);       Utilities.sleep(delay);     } else {       Logger.log(`Failed after ${attempt} attempts for assignment ${assignmentId}: ${result.error}`);       return false;     }   }      return false; } function submitGradeToCanvas(config, assignmentId, userId, score) {   const url = `https://${config.domain}/api/v1/courses/${config.courseId}/assignments/${assignmentId}/submissions/${userId}`;   const payload = { 'submission': { 'posted_grade': score } };      const options = {     method: 'put',     headers: {       'Authorization': 'Bearer ' + config.apiKey,       'Content-Type': 'application/json'     },     payload: JSON.stringify(payload),     muteHttpExceptions: true   };      try {     const response = UrlFetchApp.fetch(url, options);     const statusCode = response.getResponseCode();          if (statusCode >= 200 && statusCode < 300) {       return { success: true, shouldRetry: false };     }          // Rate limiting or server errors - retry     if (statusCode === 429 || statusCode >= 500) {       const errorBody = response.getContentText();       return {          success: false,          shouldRetry: true,          error: `HTTP ${statusCode}: ${errorBody.substring(0, 100)}`        };     }          // Client errors (4xx) - don't retry     const errorBody = response.getContentText();     Logger.log(`Canvas submission failed (${statusCode}): ${errorBody}`);     return {        success: false,        shouldRetry: false,        error: `HTTP ${statusCode}: ${errorBody.substring(0, 100)}`      };        } catch (e) {     // Network errors - retry     Logger.log(`Submit error: ${e}`);     return {        success: false,        shouldRetry: true,        error: `Exception: ${e.message}`      };   } } // === MENU & UI === function onOpen() {   const ui = SpreadsheetApp.getUi();      ui.createMenu('Grade 7 Sync')     .addItem('‚öôÔ∏è Setup Mapping', 'setupGrade7Mapping')     .addItem('üîÑ Sync to Canvas', 'syncGrade7ToCanvas')     .addToUi();      ui.createMenu('Grade 8 Sync')     .addItem('‚öôÔ∏è Setup Mapping', 'setupGrade8Mapping')     .addItem('üîÑ Sync to Canvas', 'syncGrade8ToCanvas')     .addToUi();      ui.createMenu('Both Grades')     .addItem('üîÑ Sync Both to Canvas', 'syncBothGradesToCanvas')     .addSeparator()     .addItem('ü§ñ Enable Auto-Sync', 'enableAutoSync')     .addItem('‚è∏Ô∏è Disable Auto-Sync', 'disableAutoSync')     .addSeparator()     .addItem('üìä View Sync Dashboard', 'showSyncDashboard')     .addItem('‚öôÔ∏è Show Current Mode', 'showCurrentMode')     .addItem('üîå Test Canvas Connection', 'testCanvasConnection')     .addSeparator()     .addSubMenu(ui.createMenu('üß™ Dry Run Mode')       .addItem('‚úÖ Enable Dry Run (Test Mode)', 'enableDryRunMode')       .addItem('‚ùå Disable Dry Run (Live Mode)', 'disableDryRunMode'))     .addToUi(); } // === MONITORING & UTILITIES === /**  * Test Canvas API connection  * Useful for troubleshooting authentication issues  */ function testCanvasConnection() {   const ui = SpreadsheetApp.getUi();      try {     // Test Grade 7 connection     const grade7Assignments = getAllCanvasAssignments(GRADE_7);     const grade7Users = getCanvasUsersByEmail(GRADE_7);          // Test Grade 8 connection     const grade8Assignments = getAllCanvasAssignments(GRADE_8);     const grade8Users = getCanvasUsersByEmail(GRADE_8);          const message = '‚úÖ CANVAS API CONNECTION TEST PASSED\n\n' +       `üìó Grade 7:\n` +       `  ‚Ä¢ ${grade7Assignments.length} assignments found\n` +       `  ‚Ä¢ ${Object.keys(grade7Users).length} students found\n\n` +       `üìò Grade 8:\n` +       `  ‚Ä¢ ${grade8Assignments.length} assignments found\n` +       `  ‚Ä¢ ${Object.keys(grade8Users).length} students found\n\n` +       'API key is valid and courses are accessible.';          ui.alert(message);        } catch (e) {     ui.alert(       '‚ùå CANVAS API CONNECTION FAILED\n\n' +       `Error: ${e.message}\n\n` +       'Possible issues:\n' +       '‚Ä¢ API key expired or invalid\n' +       '‚Ä¢ Course IDs incorrect\n' +       '‚Ä¢ Network/firewall blocking Canvas\n' +       '‚Ä¢ Canvas API temporarily down\n\n' +       'Check execution log for details.'     );   } } function enableDryRunMode() {   const props = PropertiesService.getScriptProperties();   props.setProperty('DRY_RUN_MODE', 'true');      SpreadsheetApp.getUi().alert(     'üß™ DRY RUN MODE ENABLED\n\n' +     '‚úì All syncs will be SIMULATED\n' +     '‚úì No changes will be made to Canvas\n' +     '‚úì Check execution log to see what WOULD happen\n\n' +     'Perfect for testing new mappings or configurations.\n\n' +     'Use "Disable Dry Run" when ready for live syncing.'   ); } function disableDryRunMode() {   const props = PropertiesService.getScriptProperties();   props.setProperty('DRY_RUN_MODE', 'false');      SpreadsheetApp.getUi().alert(     '‚úÖ DRY RUN MODE DISABLED\n\n' +     '‚ö†Ô∏è Syncs will now UPDATE Canvas grades\n' +     '‚úì Normal production mode active\n\n' +     'Grades will be synced to Canvas on next sync.'   ); } function showCurrentMode() {   const dryRunStatus = isDryRunMode() ? 'üß™ DRY RUN (Safe Mode)' : '‚úÖ LIVE MODE (Production)';   const triggers = ScriptApp.getProjectTriggers();   const autoSyncStatus = triggers.some(t => t.getHandlerFunction() === 'smartSync') ? '‚úÖ ENABLED' : '‚ùå DISABLED';      SpreadsheetApp.getUi().alert(     '‚öôÔ∏è CURRENT SETTINGS\n\n' +     `Sync Mode: ${dryRunStatus}\n` +     `Auto-Sync: ${autoSyncStatus}\n\n` +     (isDryRunMode() ?        'üß™ Syncs are being SIMULATED (no Canvas changes)\nUse "Disable Dry Run" to go live.' :       '‚úÖ Syncs are LIVE (updating Canvas gradebook)\nUse "Enable Dry Run" to test safely.')   ); } function showSyncDashboard() {   const ss = SpreadsheetApp.getActiveSpreadsheet();   const logSheet = ss.getSheetByName(LOG_SHEET_NAME);      if (!logSheet) {     SpreadsheetApp.getUi().alert('No sync log found. Run a sync first.');     return;   }      const logData = logSheet.getDataRange().getValues();   if (logData.length <= 1) {     SpreadsheetApp.getUi().alert('No sync history yet. Run a sync first.');     return;   }      const recentEvents = logData.slice(-50).reverse();      const grade7Summary = recentEvents.find(row => row[1] === 'Grade 7' && row[4] === 'COMPLETE');   const grade8Summary = recentEvents.find(row => row[1] === 'Grade 8' && row[4] === 'COMPLETE');      const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);   const recent24h = logData.filter(row => row[0] && new Date(row[0]) > oneDayAgo);      const errorCount24h = recent24h.filter(row => row[4] === 'ERROR').length;   const syncCount24h = recent24h.filter(row => row[4] === 'SYNCED').length;   const zeroCount24h = recent24h.filter(row => row[4] === 'ZERO_SYNCED').length;      let dashboard = 'üìä SYNC MONITORING DASHBOARD\n';   dashboard += '‚ïê'.repeat(50) + '\n\n';      dashboard += 'üïê LAST 24 HOURS:\n';   dashboard += `  ‚Ä¢ ${syncCount24h} grades synced\n`;   dashboard += `  ‚Ä¢ ${zeroCount24h} zeros filled\n`;   dashboard += `  ‚Ä¢ ${errorCount24h} errors\n\n`;      if (grade7Summary) {     dashboard += 'üìó GRADE 7 (Last Sync):\n';     dashboard += `  Time: ${grade7Summary[0]}\n`;     dashboard += `  ${grade7Summary[6]}\n\n`;   } else {     dashboard += 'üìó GRADE 7: No recent sync\n\n';   }      if (grade8Summary) {     dashboard += 'üìò GRADE 8 (Last Sync):\n';     dashboard += `  Time: ${grade8Summary[0]}\n`;     dashboard += `  ${grade8Summary[6]}\n\n`;   } else {     dashboard += 'üìò GRADE 8: No recent sync\n\n';   }      const triggers = ScriptApp.getProjectTriggers();   const autoSyncEnabled = triggers.some(t => t.getHandlerFunction() === 'smartSync');      dashboard += 'ü§ñ AUTO-SYNC: ' + (autoSyncEnabled ? '‚úÖ ENABLED' : '‚ùå DISABLED') + '\n';   dashboard += 'üß™ DRY RUN: ' + (isDryRunMode() ? '‚úÖ ON (Safe Mode)' : '‚ùå OFF (Live Mode)') + '\n';   dashboard += '‚ïê'.repeat(50) + '\n';   dashboard += '\nView full log in "Sync Log" sheet';      SpreadsheetApp.getUi().alert(dashboard); } 